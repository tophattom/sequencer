<html ng-app="sequencer">
    <head>
        <title>Sequencer</title>
        
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.0-rc.0/angular.js" charset="utf-8"></script>
        
        <script src="js/audio-cell.js" charset="utf-8"></script>
        
        <script src="js/app.js" charset="utf-8"></script>
        
        <script src="js/controllers/main.js" charset="utf-8"></script>
        
        <link rel="stylesheet" href="css/main.css" media="screen" title="no title" charset="utf-8">
        
        <script charset="utf-8">
            var audioCtx = new AudioContext();
            
            var gainNode = audioCtx.createGain();
            
            var cells = [];
            
            // scale.forEach(function(freq, index) {
            //     var newCell = new AudioCell(audioCtx, gainNode, freq);
            //     
            //     cells.push(newCell);
            //     
            //     newCell.onended = function(event) {
            //         var nextCell = cells[(index + 1) % 8];
            //         nextCell.start();
            //         nextCell.stop(1);
            //     };     
            // });
            
            // cells[0].start();
            // cells[0].stop(1);
            
            
            
            gainNode.gain.value = 0.2;
            
            gainNode.connect(audioCtx.destination);
            
        </script>
    </head>
    
    <body>
        <div id="sequencer-matrix" ng-controller="MainCtrl as mainCtrl">
            <table>
                <tbody>
                    <tr ng-repeat="note in mainCtrl.scale | orderBy:'freq':true">
                        <td ng-repeat="beat in mainCtrl.getBeats() track by $index"
                            ng-click="mainCtrl.addAudioCell($index, note)">
                            
                            <div class="cell"
                                ng-class="{'current-beat': $index === mainCtrl.currentBeat,
                                    'on': mainCtrl.getAudioCell($index, note) !== null}">
                            </div>
                            
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </body>
</html>