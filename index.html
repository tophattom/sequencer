<html ng-app="sequencer">
    <head>
        <title>Sequencer</title>
        
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.0-rc.2/angular.js" charset="utf-8"></script>
        
        <script src="js/audio-cell.js" charset="utf-8"></script>
        <script src="js/sequencer-matrix.js" charset="utf-8"></script>
        
        <script src="js/app.js" charset="utf-8"></script>
        
        <script src="js/services/scale.js" charset="utf-8"></script>
        
        <script src="js/controllers/main.js" charset="utf-8"></script>
        
        <link href='http://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
        <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
        
        <link rel="stylesheet" href="css/synth-icons.css" media="screen" title="no title" charset="utf-8">
        <link rel="stylesheet" href="css/main.css" media="screen" title="no title" charset="utf-8">
    </head>
    
    <body>
        <div id="main-container" ng-controller="MainCtrl as mainCtrl">
            <div id="tabs-container">
                <div class="tab"
                    ng-class="{'current-tab': matrix === mainCtrl.currentMatrix}"
                    ng-repeat="matrix in mainCtrl.matrices"
                    ng-click="mainCtrl.currentMatrix = matrix">
                    
                    <p>{{matrix.name}}</p>
                    <a href="" ng-click="mainCtrl.deleteMatrix($index)" ng-if="mainCtrl.matrices.length > 1">
                        <i class="fa fa-times"></i>
                    </a>
                </div>
                
                <div class="tab add-tab">
                    <a href="" ng-click="mainCtrl.addMatrix()"><i class="fa fa-plus"></i></a>
                </div>
            </div>
            
            <div id="matrix-container" ng-mouseleave="mainCtrl.mouseDown = false">
                <table cellspacing="0" id="sequencer-matrix">
                    <tbody>
                        <tr ng-repeat="note in mainCtrl.scale | orderBy:'freq':true">
                            <td ng-repeat="beat in mainCtrl.beats track by $index"
                                ng-mouseup="mainCtrl.mouseDown = false"
                                ng-class="{'bar-even': mainCtrl.Math.floor($index / mainCtrl.beatsPerBar) % 2 === 0}">
                                
                                <div class="master-cell">
                                    <div class="cell"
                                        ng-repeat="subCell in mainCtrl.currentMatrix.getAudioCell($index, note) track by $index"
                                        ng-mousedown="mainCtrl.handleMouseDown($event, $parent.$index, note, $index)"
                                        ng-mouseup="mainCtrl.mouseDown = false"
                                        ng-mouseenter="mainCtrl.handleMouseEnter($event, $parent.$index, note, $index)"
                                        ng-class="{'current-beat': $parent.$index === mainCtrl.currentMatrix.currentBeat,
                                            'on': subCell !== null}">
                                            
                                        <span class="note-name">{{note.name}}</span>
                                    </div>    
                                </div>
                                
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div id="tools-container">
                <div id="playback-controls" class="control-group">
                    <a href="" ng-click="mainCtrl.start()" ng-class="{'disabled-true': mainCtrl.playing}"><i class="fa fa-play fa-2x"></i></a>
                    <a href="" ng-click="mainCtrl.stop()" ng-class="{'disabled-true': !mainCtrl.playing}"><i class="fa fa-stop fa-2x"></i></a>
                </div>
                
                <div class="control-group">
                    <form class="control-form">
                        <button>GLOBAL SETTINGS</button>
                        <button>MATRIX TOOLS</button>
                        <button>MIXER</button>
                    </form>
                </div> 
                <!-- 
                <div class="control-group">
                    <form class="control-form" ng-submit="mainCtrl.lengthChanged()">
                        <label for="bpm">
                            BPM:
                            <input type="number" id="bpm" class="short" ng-model="mainCtrl.bpm" ng-change="mainCtrl.bpmChanged()">
                        </label>
                        
                        <label for="bars">
                            BARS:
                            <input type="number" id="bars" class="short" ng-model="mainCtrl.bars" ng-model-options="{updateOn: 'blur'}" ng-change="mainCtrl.lengthChanged()">    
                        </label>
                        
                        <label for="beats-per-bar">
                            BEATS / BAR:
                            <input type="number" id="beats-per-bar" class="short" ng-model="mainCtrl.beatsPerBar" ng-model-options="{updateOn: 'blur'}" ng-change="mainCtrl.lengthChanged()">
                        </label>      
                        
                        <input type="submit" class="hidden">                  
                    </form>    
                </div>
                
                <div class="control-group">
                    <form class="control-form" ng-submit="mainCtrl.generateNewScale()">
                        <label for="scale-key">
                            SCALE:
                            <select id="scale-key" ng-model="mainCtrl.newScale.key"
                                ng-options="scale.key as scale.name for scale in mainCtrl.availableScales | orderBy:'name'">
                                
                            </select>
                        </label>
                        
                        <label for="scale-start-note-name">
                            KEY:
                            <input type="text" id="scale-start-note-name" class="short" ng-model="mainCtrl.newScale.startNote.name" required>
                        </label>
                        
                        <label for="scale-start-note-octave">
                            OCTAVE:
                            <input type="number" id="scale-start-note-octave" class="short" ng-model="mainCtrl.newScale.startNote.octave" required>
                        </label>
                        
                        <label for="scale-octaves">
                            # OCTAVES:
                            <input type="number" id="scale-octaves" class="short" ng-model="mainCtrl.newScale.octaves">
                        </label>
                        
                        <button type="submit">GENERATE</button>
                    </form>
                </div>
                
                <div class="control-group">
                    <a href="" ng-click="mainCtrl.toggleWaveType()"><i class="si si-wave-{{mainCtrl.currentMatrix.waveType}}"></i></a>
                </div> -->
                
                <a href="" ng-click="mainCtrl.clear()"><i class="fa fa-times fa-2x"></i></a>
            </div>
        </div>
    </body>
</html>